<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranking Ubatuba de Ciclismo - R.U.C.</title>
    <link rel="icon" href="assets/img/favicon.ico" type="image/x-icon">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <img src="assets/img/Logo-RC4-Sports.png" alt="Logo RC4 Sports" class="logo">
            <h1>Ranking Ubatuba de Ciclismo - R.U.C.</h1>
            <p class="subtitle">Inscreva-se e desafie seus limites!</p>
        </header>
        
        <div class="tabs">
            <button class="tab active" data-tab="active-races">Provas Ativas</button>
            <button class="tab" data-tab="finished-races">Eventos Finalizados</button>
        </div>
        
        <div class="tab-content active" id="active-races">
            <div id="races-container">
                <div class="loading-spinner" id="races-spinner"></div>
            </div>
        </div>
        
        <div class="tab-content" id="finished-races">
            <div id="finished-races-container">
                <div class="loading-spinner" id="finished-races-spinner"></div>
            </div>
        </div>
        
        <div class="login-container" id="login-section">
            <button id="login-btn" class="btn login-btn">Login Admin</button>
        </div>
        
        <div class="admin-panel" id="admin-panel">
            <h2>Painel Administrativo</h2>
            <p>Você está logado como administrador.</p>
            <div class="admin-actions">
                <button id="add-race-btn" class="btn btn-primary">Adicionar Nova Prova</button>
                <button id="logout-btn" class="btn logout-btn">Logout</button>
            </div>
        </div>
        
        <!-- Modal de inscrição -->
        <div id="register-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Inscrição na Prova</h2>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <p id="race-selected-name" style="font-weight: bold; margin-bottom: 20px; font-size: 1.1rem;"></p>
                    
                    <div class="form-group">
                        <label for="full-name">Nome Completo:</label>
                        <input type="text" id="full-name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="birth-date">Data de Nascimento (DD-MM-AAAA):</label>
                        <input type="text" id="birth-date" placeholder="DD-MM-AAAA" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">Telefone:</label>
                        <input type="tel" id="phone" placeholder="(00) 00000-0000" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="voucher-code">Código de Desconto/Voucher (opcional):</label>
                        <input type="text" id="voucher-code" placeholder="Digite o código de desconto">
                    </div>
                    
                    <!-- Categorias -->
                    <div id="category-section" class="form-group">
                        <label for="category">Categoria:</label>
                        <select id="category" required>
                            <option value="">Carregando categorias...</option>
                        </select>
                    </div>
                    
                    <!-- Modalidades -->
                    <div id="modality-section" class="form-group">
                        <label for="modality">Modalidade:</label>
                        <select id="modality" required>
                            <option value="">Carregando modalidades...</option>
                        </select>
                    </div>
                    
                    <div class="loading-spinner" id="register-spinner"></div>
                </div>
                <div class="modal-footer">
                    <button id="confirm-register-btn" class="btn btn-success">Confirmar Inscrição</button>
                </div>
            </div>
        </div>
        
        <!-- Modal de login -->
        <div id="login-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Login Administrativo</h2>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="login-form">
                        <div class="form-group">
                            <label for="admin-email">Email:</label>
                            <input type="email" id="admin-email" required>
                        </div>
                        <div class="form-group">
                            <label for="admin-password">Senha:</label>
                            <input type="password" id="admin-password" required>
                        </div>
                        <p id="login-error" style="color: var(--accent); display: none;">Email ou senha incorretos.</p>
                    </form>
                </div>
                <div class="modal-footer">
                    <button id="confirm-login-btn" class="btn btn-success">Login</button>
                </div>
            </div>
        </div>
        
        <!-- Modal de adição/edição de prova -->
        <div id="race-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="race-modal-title">Adicionar Nova Prova</h2>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="race-name">Nome da Prova:</label>
                        <input type="text" id="race-name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="race-date">Data da Prova:</label>
                        <input type="date" id="race-date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="race-price">Valor da Inscrição (R$):</label>
                        <input type="number" id="race-price" min="0" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="race-description">Descrição (opcional):</label>
                        <textarea id="race-description" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="race-image-url">URL da Imagem (opcional):</label>
                        <input type="text" id="race-image-url" placeholder="Cole a URL da imagem aqui">
                    </div>
                    
                    <div class="form-group">
                        <label for="regulation-link">Link do Regulamento (Google Drive):</label>
                        <input type="text" id="regulation-link" placeholder="Cole o link compartilhável do Google Drive">
                        <small>Certifique-se de que o link está configurado como "Qualquer pessoa com o link pode visualizar"</small>
                    </div>
                    
                    <div class="loading-spinner" id="race-spinner"></div>
                </div>
                <div class="modal-footer">
                    <button id="save-race-btn" class="btn btn-success">Salvar Prova</button>
                    <button id="delete-race-btn" class="btn btn-danger" style="display: none;">Excluir Prova</button>
                </div>
            </div>
        </div>
        
        <!-- Modal de visualização de inscritos (Start List) -->
        <div id="startlist-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="startlist-modal-title">Lista de Inscritos</h2>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <p id="startlist-race-name" style="font-weight: bold; margin-bottom: 20px; font-size: 1.1rem;"></p>
                    
                    <div id="status-filter-group" class="form-group" style="display: none;">
                        <label for="status-filter">Filtrar por status:</label>
                        <select id="status-filter" class="status-filter">
                            <option value="all">Todos</option>
                            <option value="pending">Contato Pendente</option>
                            <option value="waiting">Aguardando Pagamento</option>
                            <option value="completed">Inscrição Concluída</option>
                        </select>
                    </div>
                    
                    <div class="table-container">
                        <table class="inscriptions-table">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Categoria</th>
                                    <th id="modality-header" style="display: none;">Modalidade</th>
                                    <th id="voucher-header" style="display: none;">Voucher</th>
                                    <th id="status-header" style="display: none;">Status</th>
                                    <th id="admin-actions-header" style="display: none;">Ações</th>
                                </tr>
                            </thead>
                            <tbody id="startlist-list">
                                <!-- Inscrições serão carregadas aqui -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="loading-spinner" id="startlist-spinner"></div>
                </div>
                <div class="modal-footer">
                    <button id="close-startlist-btn" class="btn btn-primary">Fechar</button>
                </div>
            </div>
        </div>
        
        <!-- Modal de edição de inscrito -->
        <div id="rider-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Editar Inscrito</h2>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <p id="rider-race-name" style="font-weight: bold; margin-bottom: 20px; font-size: 1.1rem;"></p>
                    
                    <div class="form-group">
                        <label for="edit-name">Nome Completo:</label>
                        <input type="text" id="edit-name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-birth-date">Data de Nascimento:</label>
                        <input type="text" id="edit-birth-date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-phone">Telefone:</label>
                        <input type="tel" id="edit-phone" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-voucher-code">Código de Desconto/Voucher:</label>
                        <input type="text" id="edit-voucher-code">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-category">Categoria:</label>
                        <select id="edit-category">
                            <option value="">Carregando categorias...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-modality">Modalidade:</label>
                        <select id="edit-modality">
                            <option value="">Carregando modalidades...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-status">Status:</label>
                        <select id="edit-status" required>
                            <option value="pending">Contato Pendente</option>
                            <option value="waiting">Aguardando Pagamento</option>
                            <option value="completed">Inscrição Concluída</option>
                        </select>
                    </div>
                    
                    <div class="loading-spinner" id="rider-spinner"></div>
                </div>
                <div class="modal-footer">
                    <button id="save-rider-btn" class="btn btn-success">Salvar Alterações</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/firebase-config.js"></script>
    <script src="js/categories-modalities.js"></script>
    <script src="js/script.js"></script>
</body>
</html>